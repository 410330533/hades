  redis:
    restart: always
    image: sameersbn/redis:latest
    volumes:
        - /srv/docker/gitlab/redis:/var/lib/redis

  # postgresql:
    # restart: always
    # image: sameersbn/postgresql:9.6-2
    # volumes:
        # - /srv/docker/gitlab/postgresql:/var/lib/postgresql
    # environment:
        # - DB_NAME=gitlabhq_production
        # - DB_USER=gitlab
        # - DB_PASS=password
        # - DB_EXTENSION=pg_trgm

  mysql:
    restart: always
    image: sameersbn/mysql:latest
    volumes:
        - /srv/docker/gitlab/mysql:/var/lib/mysql
    environment:
        - DB_NAME=gitlabhq_production
        - DB_USER=gitlab
        - DB_PASS=password

  gitlab:
    restart: always
    image: sameersbn/gitlab:9.0.0
    ports:
        - "10080:80"
        - "10022:22"
    volumes:
        - /srv/docker/gitlab/gitlab:/home/git/data
    links:
        - redis:redisio
        - mysql:mysql
    environment:
        - GITLAB_TIMEZONE=Beijing
        - GITLAB_PORT=10080
        - GITLAB_SSH_PORT=10022
        - GITLAB_SECRETS_DB_KEY_BASE=Vb3bzsntLbhmhVpNcssVxKdznqxqnHbJPfNtvqLfJczC4v7cCK3hWvHdzK4tw4v4
        - GITLAB_SECRETS_SECRET_KEY_BASE=Vb3bzsntLbhmhVpNcssVxKdznqxqnHbJPfNtvqLfJczC4v7cCK3hWvHdzK4tw4v4
        - GITLAB_SECRETS_OTP_KEY_BASE=Vb3bzsntLbhmhVpNcssVxKdznqxqnHbJPfNtvqLfJczC4v7cCK3hWvHdzK4tw4v4
